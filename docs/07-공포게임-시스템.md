# 공포 게임 시스템

이 프로젝트에 만들어진 공포 게임 시스템을 알아봅시다!

---

## 게임 흐름 이해하기

```
┌─────────────────────────────────────────────────────┐
│                    게임 시작                         │
└─────────────────────┬───────────────────────────────┘
                      ↓
┌─────────────────────────────────────────────────────┐
│            맵을 돌아다니며 열쇠 찾기                   │
│                                                     │
│  - 손전등으로 어두운 곳 비추기                        │
│  - 살인마 피하기 (숨거나 도망)                        │
│  - 배터리 줍기 (손전등 충전)                          │
└─────────────────────┬───────────────────────────────┘
                      ↓
            ┌─────────┴─────────┐
            ↓                   ↓
    ┌───────────────┐   ┌───────────────┐
    │  열쇠 모두 획득 │   │  살인마에게 잡힘 │
    └───────┬───────┘   └───────┬───────┘
            ↓                   ↓
    ┌───────────────┐   ┌───────────────┐
    │  탈출구로 이동  │   │   게임 오버    │
    └───────┬───────┘   └───────────────┘
            ↓
    ┌───────────────┐
    │     승리!      │
    └───────────────┘
```

---

## 플레이어 시스템

### VRPlayer (플레이어 캐릭터)

플레이어의 체력, 스태미나, 숨기 기능을 담당해요.

**주요 기능:**

| 기능 | 설명 |
|------|------|
| 스태미나 | 달릴 때 소모, 시간이 지나면 회복 |
| 숨기 | 특정 장소에서 숨을 수 있음 |
| 소음 | 달리면 소음이 나서 살인마가 들을 수 있음 |

**Unity에서 설정하기:**

1. 플레이어 오브젝트 선택
2. Inspector에서 VRPlayer 컴포넌트 찾기
3. 원하는 값 수정:

| 설정 | 기본값 | 설명 |
|------|--------|------|
| Max Stamina | 100 | 최대 스태미나 |
| Sprint Stamina Cost | 20 | 달릴 때 초당 소모량 |
| Stamina Regen Rate | 10 | 초당 회복량 |
| Walk Noise Radius | 3 | 걸을 때 소음 범위 (미터) |
| Sprint Noise Radius | 8 | 달릴 때 소음 범위 (미터) |

### 코드에서 사용하기 (개발자용)

```csharp
// 플레이어 찾기 (싱글톤)
VRPlayer player = VRPlayer.Instance;

// 현재 스태미나 확인
float stamina = player.currentStamina;  // 0~100

// 플레이어가 숨어있는지 확인
if (player.IsHiding) {
    Debug.Log("플레이어가 숨어있음!");
}

// 플레이어가 소음을 내게 하기
player.MakeNoise(5f);  // 5미터 반경으로 소음 발생
```

---

### VRFlashlight (손전등)

배터리가 있는 손전등이에요. 배터리가 없으면 꺼져요!

**Unity에서 설정하기:**

| 설정 | 기본값 | 설명 |
|------|--------|------|
| Max Battery | 100 | 최대 배터리 |
| Drain Rate | 5 | 초당 소모량 |
| Light Component | - | 연결할 Light 오브젝트 |

**코드에서 사용하기:**

```csharp
VRFlashlight flashlight = player.GetComponentInChildren<VRFlashlight>();

flashlight.Toggle();      // 켜기/끄기 토글
flashlight.TurnOn();      // 켜기
flashlight.TurnOff();     // 끄기

// 배터리 확인 (0~1 사이 값)
float battery = flashlight.BatteryPercent;

// 배터리 충전 (50% 충전)
flashlight.RechargeBattery(50f);
```

---

## 살인마 시스템

### KillerAI (살인마)

플레이어를 찾아다니는 무서운 적이에요!

**살인마의 상태:**

```
순찰 (Patrol)
    │
    │ 소리를 들음
    ↓
수색 (Search)
    │
    │ 플레이어 발견
    ↓
추적 (Chase)
    │
    │ 플레이어를 놓침
    ↓
조사 (Investigate)
    │
    │ 포기
    ↓
순찰 (Patrol)
```

**Unity에서 설정하기:**

1. 적 캐릭터 오브젝트 선택
2. Inspector에서 KillerAI 컴포넌트 확인

| 설정 | 기본값 | 설명 |
|------|--------|------|
| View Distance | 15 | 시야 거리 (미터) |
| View Angle | 90 | 시야 각도 (도) |
| Hearing Range | 10 | 소리 감지 거리 (미터) |
| Patrol Speed | 2 | 순찰 속도 |
| Chase Speed | 5 | 추적 속도 |
| Catch Distance | 1.5 | 잡기 거리 (미터) |

**순찰 지점 설정하기:**

1. 빈 오브젝트들을 만들어서 순찰 경로에 배치
2. KillerAI의 `Patrol Points` 배열에 드래그 앤 드롭
3. 살인마가 이 지점들을 돌아다녀요

---

## 상호작용 오브젝트

### Door (문)

열쇠가 필요한 문이에요.

**설정 방법:**

1. 문 오브젝트에 **Door** 스크립트 추가
2. 설정:

| 설정 | 설명 |
|------|------|
| Is Locked | 잠겨있는지 |
| Required Key Id | 필요한 열쇠 ID (예: "key_bedroom") |
| Open Angle | 열릴 각도 |
| Open Speed | 열리는 속도 |

**열쇠와 문 연결하기:**

```
KeyItem.keyId = "bedroom_key"
           ↓ (같은 ID)
Door.requiredKeyId = "bedroom_key"
```

ID가 같으면 그 열쇠로 문을 열 수 있어요!

### HidingSpot (숨는 장소)

옷장, 침대 밑 등 숨을 수 있는 장소예요.

**설정 방법:**

1. 숨을 장소에 **HidingSpot** 스크립트 추가
2. **Box Collider** 추가하고 **Is Trigger** 체크
3. `Hide Position`에 플레이어가 위치할 빈 오브젝트 연결

**숨을 때 일어나는 일:**
- 플레이어가 투명해져요 (살인마가 못 봐요)
- 소음이 줄어들어요
- 살인마가 지나갈 때까지 기다려요

---

### KeyItem (열쇠)

문을 열기 위한 열쇠 아이템이에요.

**설정 방법:**

1. 열쇠 오브젝트에 **KeyItem** 스크립트 추가
2. `Key Id` 설정 (문의 Required Key Id와 동일하게)
3. 플레이어가 줍기만 하면 자동 획득!

### BatteryItem (배터리)

손전등 충전 아이템이에요.

**설정 방법:**

1. 배터리 오브젝트에 **BatteryItem** 스크립트 추가
2. `Charge Amount` 설정 (기본 50%)
3. 줍기만 하면 자동 충전!

---

## 게임 관리 시스템

### HorrorGameManager (게임 관리자)

게임의 상태를 관리해요.

**게임 상태:**

| 상태 | 설명 |
|------|------|
| Menu | 메뉴 화면 |
| Playing | 게임 중 |
| Paused | 일시정지 |
| GameOver | 게임 오버 |
| Victory | 승리 |

**설정 방법:**

| 설정 | 설명 |
|------|------|
| Required Keys To Escape | 탈출에 필요한 열쇠 수 |
| Use Time Limit | 제한 시간 사용 여부 |
| Time Limit | 제한 시간 (초) |

### EscapeZone (탈출 구역)

열쇠를 모두 모으고 여기 도달하면 승리!

**설정 방법:**

1. 탈출 지점에 빈 오브젝트 생성
2. **EscapeZone** 스크립트 추가
3. **Box Collider** 추가하고 **Is Trigger** 체크

### JumpScare (점프스케어)

깜짝 놀라게 하는 공포 연출이에요!

**설정 방법:**

1. 원하는 위치에 빈 오브젝트 생성
2. **JumpScare** 스크립트 추가
3. **Box Collider** 추가하고 **Is Trigger** 체크
4. 설정:

| 설정 | 설명 |
|------|------|
| Scare Object | 갑자기 나타날 오브젝트 |
| Scare Sound | 무서운 효과음 |
| Delay | 트리거 후 지연 시간 |
| Duration | 얼마나 보여줄지 |

---

## 오디오 시스템

### HorrorAudioManager (공포 오디오)

배경음악과 긴장감을 조절해요.

**긴장 레벨:**

| 레벨 | 상황 |
|------|------|
| Calm | 평온할 때 |
| Uneasy | 불안할 때 |
| Tense | 긴장될 때 |
| Chase | 살인마에게 쫓길 때 |

각 레벨마다 다른 배경음악이 재생돼요!

---

## 다음 단계

공포 게임 시스템을 알았어요! VR 전용 스크립트를 알아봅시다.

[다음: VR 스크립트 >](08-VR-스크립트.md)
