# 맵 제작 가이드

맵 디자이너를 위한 공포 게임 맵 제작 가이드입니다.

---

## 맵 제작 도구 열기

Unity 메뉴에서:

```text
Horror Game > 맵 제작 도구
```

이 창에서 모든 맵 제작 기능을 사용할 수 있습니다.

---

## 1. NavMesh (AI 이동 영역) 설정

### NavMesh란?

NavMesh는 **AI가 이동할 수 있는 영역**을 정의합니다.

```text
파란색 영역 = AI 이동 가능
빈 영역 = AI 이동 불가
```

살인마 AI가 맵에서 움직이려면 반드시 NavMesh가 필요합니다!

### NavMesh 설정 순서

#### 1단계: 지형 오브젝트 선택

바닥, 계단, 경사로 등 **AI가 걸어다닐 수 있는 오브젝트**를 선택합니다.

#### 2단계: Navigation Static 설정

선택한 오브젝트들을 **Navigation Static**으로 설정합니다:

**방법 1: Inspector에서 수동 설정**
1. 오브젝트 선택
2. Inspector 창 상단의 `Static` 드롭다운 클릭
3. `Navigation Static` 체크

**방법 2: 맵 제작 도구 사용**
1. 오브젝트들 선택
2. 맵 제작 도구 > NavMesh 탭
3. `선택 오브젝트 Navigation Static 설정` 클릭

#### 3단계: Navigation 창 열기

```text
Window > AI > Navigation
```

또는 맵 제작 도구에서 `Navigation 창 열기` 버튼 클릭

#### 4단계: Bake 설정

Navigation 창에서 `Bake` 탭을 선택하고 설정합니다:

| 설정 | 권장값 | 설명 |
|------|--------|------|
| Agent Radius | 0.5 | 살인마 몸통 반경 |
| Agent Height | 2 | 살인마 키 |
| Max Slope | 45 | 오를 수 있는 최대 경사 |
| Step Height | 0.4 | 오를 수 있는 계단 높이 |

#### 5단계: Bake 실행

`Bake` 버튼을 클릭합니다.

성공하면 **파란색 영역**이 표시됩니다!

### 문제 해결

**파란색이 안 보여요**
- 오브젝트가 Navigation Static으로 설정되었는지 확인
- 오브젝트에 Collider가 있는지 확인

**AI가 특정 곳을 못 지나가요**
- 해당 영역이 파란색인지 확인
- Agent Radius보다 좁은 통로는 못 지나감

**계단을 못 올라가요**
- Step Height 값을 계단 높이보다 크게 설정

---

## 2. 살인마 AI 배치

### 살인마 생성

```text
맵 제작 도구 > 적 AI 탭 > 살인마 생성
```

### 순찰 지점 설정

살인마가 돌아다닐 경로를 설정합니다:

1. `순찰 지점 생성` 버튼으로 지점 추가
2. Scene 뷰에서 위치 조정
3. 원하는 만큼 지점 추가 (최소 2개 권장)
4. 살인마 선택 후 `씬의 PatrolPoint를 살인마에 연결` 클릭

```text
순찰 순서: PatrolPoint_1 → PatrolPoint_2 → PatrolPoint_3 → ...
```

### AI 난이도 조절

KillerAI 컴포넌트에서 조절:

| 설정 | 쉬움 | 보통 | 어려움 |
|------|------|------|--------|
| View Distance | 10 | 15 | 20 |
| View Angle | 60 | 90 | 120 |
| Hearing Range | 5 | 10 | 15 |
| Chase Speed | 3 | 4.5 | 6 |

---

## 3. 상호작용 오브젝트 배치

### 문

```text
맵 제작 도구 > 상호작용 탭 > 일반 문 / 잠긴 문
```

**잠긴 문 설정:**
- `Required Key Id` 에 고유 ID 입력 (예: `key_office`)
- 같은 ID의 열쇠가 있어야 열림

### 열쇠

```text
맵 제작 도구 > 상호작용 탭 > 열쇠 생성
```

**문과 연결:**
- `Key Id`를 문의 `Required Key Id`와 동일하게 설정

```text
예시:
- 문: Required Key Id = "key_office"
- 열쇠: Key Id = "key_office"
→ 열쇠를 먼저 획득해야 문이 열림
```

### 숨는 장소

```text
맵 제작 도구 > 상호작용 탭 > 옷장 / 침대 밑 / 사물함
```

플레이어가 살인마를 피해 숨을 수 있는 장소입니다.

**설정:**
- 가구 모델 추가
- Collider 크기 조절 (플레이어가 들어갈 수 있도록)

### 탈출구

```text
맵 제작 도구 > 상호작용 탭 > 탈출구 생성
```

게임의 목표 지점입니다. 열쇠를 모두 모으면 탈출 가능!

### 메모

```text
맵 제작 도구 > 상호작용 탭 > 읽을 수 있는 메모 생성
```

스토리, 힌트, 비밀번호 등을 전달합니다.

**설정:**
- `Note Title`: 메모 제목
- `Note Content`: 메모 내용

---

## 4. 이벤트 배치

### 체크포인트

```text
맵 제작 도구 > 이벤트 탭 > 체크포인트 생성
```

플레이어 진행 상황을 저장합니다.

### 랜덤 이벤트

```text
맵 제작 도구 > 이벤트 탭 > 랜덤 이벤트 트리거 생성
```

특정 구역에서 무작위 이벤트 발생 (조명 깜빡임, 소리 등)

**설정:**
- `Trigger Chance`: 발생 확률 (0~1)
- `Cooldown Time`: 재발생까지 대기 시간

### 점프스케어

```text
맵 제작 도구 > 이벤트 탭 > 점프스케어 트리거 생성
```

깜짝 놀라게 하는 이벤트입니다.

### 깜빡이는 조명

```text
맵 제작 도구 > 이벤트 탭 > 깜빡이는 조명 생성
```

공포 분위기 연출용 조명입니다.

**깜빡임 타입:**
- `Random`: 무작위 깜빡임
- `Pattern`: 패턴 깜빡임
- `Candle`: 촛불 효과
- `Broken`: 고장난 조명
- `Pulse`: 맥박처럼 천천히

---

## 5. 게임 설정 검증

맵 제작이 끝나면 검증을 실행합니다:

```text
맵 제작 도구 > 빠른 설정 탭 > 게임 설정 검증
```

검증 항목:
- ✓ 게임 매니저 존재
- ✓ VR 플레이어 설정
- ✓ 살인마 AI 배치
- ✓ 탈출구 존재
- ✓ 열쇠/문 매칭
- ✓ NavMesh Bake
- ✓ 순찰 지점 설정

---

## 맵 제작 체크리스트

```text
□ 맵 지형 완성 (바닥, 벽, 방)
□ Navigation Static 설정
□ NavMesh Bake
□ 살인마 배치
□ 순찰 지점 설정 (최소 4개)
□ 잠긴 문 배치
□ 열쇠 배치 (문과 ID 매칭)
□ 숨는 장소 배치 (적절한 간격)
□ 탈출구 배치
□ 체크포인트 배치
□ 조명 설정
□ 게임 설정 검증 통과
□ 테스트 플레이
```

---

## 팁

### 좋은 맵 설계

1. **다양한 경로** - 여러 루트로 이동 가능하게
2. **적절한 숨는 장소** - 너무 많으면 쉬움, 적으면 어려움
3. **가시선 차단** - 모퉁이, 문으로 긴장감 유발
4. **조명 활용** - 어두운 곳과 밝은 곳의 대비

### 성능 최적화

1. **오클루전 컬링** - 안 보이는 곳은 렌더링 안 함
2. **LOD** - 먼 거리 오브젝트는 간단하게
3. **라이트맵** - 정적 조명은 Bake

---

## 문제 해결

### AI가 안 움직여요

1. NavMesh가 Bake되었는지 확인
2. 살인마에 NavMeshAgent 컴포넌트 확인
3. 순찰 지점이 NavMesh 위에 있는지 확인

### 문이 안 열려요

1. 열쇠 Key Id와 문의 Required Key Id 일치 확인
2. PlayerInventory 컴포넌트 확인

### 탈출이 안 돼요

1. 필요한 열쇠 개수 확인 (HorrorGameManager)
2. EscapeZone Collider가 Is Trigger인지 확인
